# RDP质量配置界面使用指南

## 📖 概述

RDP质量配置界面是JMS Protocol Handler v1.2.0的核心功能之一，提供了直观易用的图形界面来管理RDP连接的质量设置。通过这个界面，您可以轻松调整RDP连接参数，以在性能和质量之间找到最佳平衡。

## 🚀 快速开始

### 打开配置界面

有多种方式可以打开RDP质量配置界面：

1. **菜单栏访问**：`RDP设置` → `RDP质量配置...` (快捷键: `Cmd+,`)
2. **键盘快捷键**：直接按 `Cmd+,`
3. **状态栏菜单**：点击状态栏图标 → `RDP质量配置...`
4. **全局快捷键**：`Option+Cmd+R`（如果启用）

### 界面布局

配置界面采用原生macOS设计，包含以下主要区域：

```
┌─────────────────────────────────────────────────────┐
│ 🎛️ RDP质量配置                                      │
├─────────────────────────────────────────────────────┤
│ 工具栏: [性能优先] [平衡模式] [质量优先] | [刷新] [导出] [导入] │
├─────────────────────────────────────────────────────┤
│                                                     │
│ 预设配置: ○ 性能优先  ● 平衡模式  ○ 质量优先        │
│                                                     │
│ 压缩级别: ├────●────┤ 中等                          │
│                                                     │
│ 颜色深度: [24位 ▼]    音频质量: [中等 ▼]            │
│                                                     │
│ 特效设置:                                           │
│ ☑ 字体平滑    ☑ 桌面壁纸                           │
│ ☐ 菜单动画    ☑ 视觉主题                           │
│                                                     │
│ [保存设置] [重置默认] [导出设置] [导入设置]          │
│                                                     │
│ 状态: 就绪                                          │
└─────────────────────────────────────────────────────┘
```

## 🎯 功能详解

### 1. 预设配置文件

系统提供三种预设配置，适用于不同的网络环境和使用场景：

#### 🏃‍♂️ 性能优先 (快捷键: `Cmd+1`)
- **适用场景**：低带宽网络、移动网络、性能优先
- **网络要求**：< 1 Mbps
- **配置特点**：
  - 压缩级别：高压缩 (2)
  - 颜色深度：16位
  - 音频质量：禁用
  - 特效：全部禁用
- **优势**：最低带宽占用，最快响应速度
- **适合用户**：移动办公、网络条件较差的环境

#### ⚖️ 平衡模式 (快捷键: `Cmd+2`)
- **适用场景**：一般办公环境、宽带网络连接
- **网络要求**：1-3 Mbps
- **配置特点**：
  - 压缩级别：中等压缩 (1)
  - 颜色深度：24位
  - 音频质量：中等
  - 特效：部分启用
- **优势**：性能和质量的最佳平衡
- **适合用户**：日常办公、一般网络环境

#### 👑 质量优先 (快捷键: `Cmd+3`)
- **适用场景**：高速网络、设计和图形工作
- **网络要求**：> 5 Mbps
- **配置特点**：
  - 压缩级别：无压缩 (0)
  - 颜色深度：32位
  - 音频质量：高质量
  - 特效：全部启用
- **优势**：最佳视觉效果和用户体验
- **适合用户**：设计师、高质量要求的工作

### 2. 详细参数配置

#### 压缩级别
- **无压缩 (0)**：最佳质量，需要高带宽
- **中等 (1)**：平衡质量和带宽
- **高压缩 (2)**：最低带宽，质量有所降低

#### 颜色深度
- **16位**：65,536色，最低带宽占用
- **24位**：1,677万色，标准质量
- **32位**：真彩色，最佳视觉效果

#### 音频质量
- **禁用**：不传输音频，节省带宽
- **低质量**：基本音频传输
- **中等**：标准音频质量
- **高质量**：最佳音频体验

#### 特效设置
- **字体平滑**：改善文字显示效果
- **桌面壁纸**：显示远程桌面壁纸
- **菜单动画**：启用菜单动画效果
- **视觉主题**：启用Windows视觉主题

### 3. 工具栏功能

#### 快速切换按钮
- **性能优先**：一键切换到性能模式
- **平衡模式**：一键切换到平衡模式
- **质量优先**：一键切换到质量模式

#### 管理功能
- **刷新**：重新加载当前设置
- **导出**：将设置保存为JSON文件
- **导入**：从JSON文件加载设置

## ⌨️ 键盘快捷键

### 全局快捷键
- `Cmd+,`：打开配置窗口
- `Option+Cmd+R`：打开配置窗口（全局）

### 配置窗口内快捷键
- `Cmd+1`：切换到性能优先模式
- `Cmd+2`：切换到平衡模式
- `Cmd+3`：切换到质量优先模式
- `Cmd+Shift+S`：保存当前设置
- `Cmd+Shift+R`：重置为默认设置
- `Cmd+Shift+E`：导出设置
- `Cmd+Shift+I`：导入设置

## 💾 设置管理

### 保存设置
1. 调整配置参数到满意状态
2. 点击 `保存设置` 按钮或使用 `Cmd+Shift+S`
3. 设置将自动保存到本地文件
4. 下次启动应用时自动加载

### 导出设置
1. 点击工具栏的 `导出` 按钮或使用 `Cmd+Shift+E`
2. 选择保存位置和文件名
3. 设置将保存为JSON格式文件
4. 文件名格式：`RDP设置_YYYY-MM-DD_HH-MM-SS.json`

### 导入设置
1. 点击工具栏的 `导入` 按钮或使用 `Cmd+Shift+I`
2. 选择要导入的JSON设置文件
3. 系统将验证文件格式并应用设置
4. 导入成功后界面自动更新

### 重置设置
1. 点击 `重置默认` 按钮或使用 `Cmd+Shift+R`
2. 确认重置操作
3. 所有设置将恢复为默认的平衡模式

## 🔔 通知和反馈

### 系统通知
配置界面会在以下情况显示系统通知：
- 切换质量配置时
- 保存设置成功时
- 重置设置完成时
- 导入/导出操作完成时

### 状态指示
界面底部的状态栏显示当前操作状态：
- `就绪`：系统准备就绪
- `设置已更改`：配置参数已修改
- `保存成功`：设置保存完成
- `导入成功`：设置导入完成

## 🎨 界面自定义

### 窗口大小
- **默认尺寸**：520×480 像素
- **最小尺寸**：480×400 像素
- **最大尺寸**：600×600 像素
- **可调整**：支持拖拽调整窗口大小

### 显示模式
- **浮动窗口**：始终显示在其他窗口之上
- **多空间支持**：可在所有桌面空间中显示
- **全屏辅助**：支持全屏模式下的辅助显示

## 🔧 高级功能

### 实时预览
- 配置更改时立即显示效果预览
- 网络带宽使用估算
- 质量影响评估

### 智能推荐
系统会根据以下因素提供配置推荐：
- 当前网络环境
- 历史使用模式
- 设备性能特征

### 批量操作
- 支持批量导入多个配置文件
- 配置文件版本管理
- 配置对比和合并

## 📊 性能指标

### 界面性能
- **启动时间**：< 100ms
- **配置切换**：< 10ms
- **设置保存**：< 50ms
- **内存占用**：< 5MB

### 配置效果
不同配置对RDP连接的影响：

| 配置模式 | 带宽需求 | 延迟 | 画质 | 音质 | 适用场景 |
|---------|---------|------|------|------|---------|
| 性能优先 | < 1 Mbps | 最低 | 基础 | 无 | 移动网络 |
| 平衡模式 | 1-3 Mbps | 中等 | 良好 | 标准 | 办公环境 |
| 质量优先 | > 5 Mbps | 较高 | 优秀 | 高质量 | 设计工作 |

## 🛠️ 故障排除

### 常见问题

#### 1. 配置窗口无法打开
**症状**：点击菜单项或快捷键无响应
**解决方案**：
```bash
# 检查应用程序状态
ps aux | grep JMSProtocolHandler

# 重启应用程序
killall JMSProtocolHandler
open /Applications/JMSProtocolHandler.app
```

#### 2. 设置保存失败
**症状**：点击保存按钮后显示错误
**解决方案**：
```bash
# 检查配置文件权限
ls -la ~/Library/Application\ Support/JMSProtocolHandler/

# 重置配置目录权限
chmod 755 ~/Library/Application\ Support/JMSProtocolHandler/
chmod 644 ~/Library/Application\ Support/JMSProtocolHandler/*.json
```

#### 3. 快捷键不响应
**症状**：键盘快捷键无效
**解决方案**：
1. 检查系统偏好设置 → 键盘 → 快捷键
2. 确保没有冲突的快捷键设置
3. 重启应用程序

#### 4. 导入设置失败
**症状**：选择JSON文件后提示格式错误
**解决方案**：
1. 验证JSON文件格式
2. 检查文件编码（应为UTF-8）
3. 使用系统导出的文件作为模板

### 诊断工具

#### 配置验证
```bash
# 验证当前配置
./scripts/test/validate_rdp_settings.sh

# 检查配置文件完整性
./scripts/test/check_settings_integrity.sh
```

#### 日志查看
```bash
# 查看应用程序日志
log show --predicate 'process == "JMSProtocolHandler"' --last 1h

# 查看配置相关日志
log show --predicate 'process == "JMSProtocolHandler" AND message CONTAINS "RDP"' --last 1h
```

## 📚 相关文档

- [显示优化使用指南](显示优化使用指南.md)
- [显示配置故障排除指南](显示配置故障排除指南.md)
- [JMS协议注册指南](JMS_PROTOCOL_REGISTRATION_GUIDE.md)
- [用户手册](用户手册.txt)

## 🤝 技术支持

如果您在使用过程中遇到问题，可以：

1. **查看日志**：检查应用程序日志获取详细错误信息
2. **重置设置**：尝试重置为默认配置
3. **重新安装**：卸载并重新安装应用程序
4. **联系支持**：通过GitHub Issues报告问题

## 📝 更新日志

### v1.2.0 (2025-08-13)
- ✅ 新增原生macOS配置界面
- ✅ 支持三种预设质量配置
- ✅ 添加工具栏快速操作
- ✅ 实现键盘快捷键支持
- ✅ 增加设置导入导出功能
- ✅ 优化界面响应性能

### 未来计划
- 🔄 配置模板管理
- 🔄 网络环境自动检测
- 🔄 配置使用统计
- 🔄 云端配置同步

---

**让RDP连接配置变得简单而强大！** 🚀
